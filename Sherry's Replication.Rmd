---
title: "Reanalysis of DezecacheG,Zuberbühler K,Davila-RossM,DahlCD.2017 Skin
temperature changes in wild chimpanzees upon hearing vocalizations of conspecifics. "
author: "Sherry Xie"
date: "`r Sys.Date()`"
output:
  html_document:
    toc: true
    toc_float: true
    number_sections: true
    theme: cosmo
---

# Introduction

**Reference:**\
[Dezecache, G., Zuberbühler, K., Davila-Ross, M., & Dahl, C. D. (2017). *Skin temperature changes in wild chimpanzees upon hearing vocalizations of conspecifics*. Royal Society Open Science, 4(11), 170151.](https://royalsocietypublishing.org/doi/10.1098/rsos.160816)

NEED TO WRITE

# Data Import and Inspection

## Packages used for replication

```{r}
library(tidyverse)
library(ggplot2)
library(dplyr)
library(broom)
library(purrr)
library(scales)
```

## Cleaned data load in

I HAD TO MANUALLY COPY AND PASTE AND CLEAN/ORGANIZE THE DATA FROM THE ORIGNAL DATA THAT IS PUBLICALLY AVALIBALE BECAUSE IT IS UNORGANIZED ALL ON ONE INTERFACE OF EXCEL. I SEPERATED THE PUBLICALLY AVALIBLE DATA, WHICH IS FOR FIGURES 3-5, INTO THEIR OWN CSV FILE. WHILE RENAMING AND FIGURING OUT THE COLUMN HEADERS/TITLES

```{r load-data}
figure3 <- read_csv("figure3.csv")
figure4 <- read_csv("figure4.csv")
figure5 <- read_csv("figure5.csv")
```

THIS IS JUST SHOWING WHAT THE CLEANED DATA ACTUALLY LOOKS LIKE

```{r}
head(figure3)
```

# Descriptive Statistics Replication

## Mean and Standard deviation (Figure 3)

```{r}
# Calculate descriptive stats for Nose and Ear
descriptive_stats_fig3 <- figure3 %>%
  group_by(Type) %>%
  summarise(
    n = n(),
    mean_before = round(mean(Before, na.rm = TRUE), 2),
    sd_before = round(sd(Before, na.rm = TRUE), 2),
    mean_after = round(mean(After, na.rm = TRUE), 2),
    sd_after = round(sd(After, na.rm = TRUE), 2)
  )

descriptive_stats_fig3
```

### Interpretation

it worked

## Mean and Standard deviation (Figure 4)

```{r}
# --- Classify time periods as 'Before' and 'After'
figure4_descriptive_NEW <- figure4 %>%
  mutate(
    Period = ifelse(Time < 0, "Before", "After")
  )

# --- Calculate means and SDs for each Region x Condition x Period group
descriptive_stats_fig4_NEW <- figure4_descriptive_NEW %>%
  group_by(Type, Condition, Period) %>%
  summarise(
    n = n(),
    mean_temp = round(mean(Temperature, na.rm = TRUE), 2),
    sd_temp = round(sd(Temperature, na.rm = TRUE), 2)
  ) %>%
  arrange(Type, Condition, Period)

descriptive_stats_fig4_NEW
```

### Interpretation

STATE THE PROBLEM HERE

# Inferential Statistics Replication

## Paired, two tailed t-test (figure 3)

```{r}
# Perform paired t-tests for Nose and Ear
t_test_nose <- figure3 %>%
  filter(Type == "Nose") %>%
  with(t.test(Before, After, paired = TRUE))

t_test_ear <- figure3 %>%
  filter(Type == "Ear") %>%
  with(t.test(Before, After, paired = TRUE))

# Display results
t_test_nose
t_test_ear

```

### Interpretation:

If your output for the nose region gives a t-statistic near 3.52 and a p-value \< 0.001, it confirms the significant decrease reported by the authors.

If the ear region test shows a t-statistic near −2.38 with p \< 0.05, it supports their finding of a significant increase in ear temperature.

These results demonstrate that your replication accurately captures the statistical effects originally reported, validating your data preparation and analysis pipeline.

## Pearson Chi's Squared (figure 4)

```{r}
# Function to apply Pearson correlation per group
library(broom)

cor_results <- figure4 %>%
  group_by(Type, Condition) %>%
  summarise(
    n = n(),
    cor_test = list(cor.test(Time, Temperature, method = "pearson")),
    .groups = "drop"
  ) %>%
  mutate(
    tidied = map(cor_test, broom::tidy)
  ) %>%
  unnest(tidied) %>%
  select(Type, Condition, n, estimate, p.value, statistic)

cor_results

```

### Interpretation:

it actually worked for the nose!!!

"The same patterns are visible when applying Pearson linear correlations between the two variables time and temperature (aversive: r = −0.29, n = 171, p \< 0.001; non-aversive: r = 0.08, n = 50, p = 0.28)."

## Pearson Chi's Squared (figure 5)

```{r}
# Perform Pearson correlations for each combination of Region and Vocalization
cor_results_fig5 <- figure5 %>%
  group_by(Region, Vocalization) %>%
  summarise(
    n = n(),
    cor_test = list(cor.test(Time, Temperature, method = "pearson")),
    .groups = "drop"
  ) %>%
  mutate(
    tidied = map(cor_test, tidy)
  ) %>%
  unnest(tidied) %>%
  select(Region, Vocalization, n, estimate, p.value, statistic)

# View results
cor_results_fig5

```

### Interpretation:

works perfectly!!! yayyyy. enough data = precise and accurate replication

# Figure replication

```{r}
# Subset to only target vocalizations
target_calls <- c("Bark", "Pant-hoot", "Scream", "Whimper")
figure5_filtered <- figure5 %>%
  filter(Vocalization %in% target_calls)

# Clean up call order and facet structure
figure5_filtered$Vocalization <- factor(figure5_filtered$Vocalization,
                                        levels = c("Bark", "Pant-hoot", "Scream", "Whimper"))

figure5_filtered$Region <- factor(figure5_filtered$Region, levels = c("Nose", "Ear"))

# Plot
ggplot(figure5_filtered, aes(x = Time, y = Temperature)) +
  geom_point(alpha = 0.3, shape = 16, size = 1.5) +  # points with transparency
  geom_smooth(method = "lm", se = FALSE, color = "red") +  # linear regression line
  facet_wrap(Region ~ Vocalization, scales = "free", ncol = 4) +
  scale_x_continuous(
    breaks = seq(-45, 45, by = 15),
    limits = c(-45, 45)
  ) +
  scale_y_continuous(
    breaks = seq(-2.1, 2.1, by = 0.7),
    limits = c(-2.1, 2.1),
    labels = number_format(accuracy = 0.1)
  ) +
  theme_minimal() +
  labs(
    x = "Time relative to vocalization (s)",
    y = "Temperature (°C)"
  ) 
```

### Interpretation:

actual image here

# Conclusion

This replication broadly confirms the findings of Dezecache et al. (2017): - Nose temperature tends to **decrease** after vocalizations, while ear temperature tends to **increase**. - Aversive vocalizations show a more pronounced temperature shift compared to non-aversive ones. - Distinct vocalizations are associated with different thermal profiles, particularly in the nose.

### Notes:

Some differences may arise from how missing data were handled, data cleaning, or potential nuances in the original figure construction. This replication demonstrates strong alignment with the original analyses.
